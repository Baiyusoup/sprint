---
title: XSS和CSRF
date: 2021-07-12
categories: 
 - 浏览器
---

## XSS
跨站脚本攻击是指在浏览器中执行恶意脚本，从而拿到用户的信息并进行操作。这些操作一般可以窃取cookie、监听用户行为、伪造登录表单、生成浮窗广告。

通常情况XSS攻击的实现有三种方式：存储型、反射性和文档型。

### 存储型
攻击方式是将恶意脚本存储到服务端的数据库，然后用户打开网站时，浏览器会进行渲染，执行这些脚本。

### 反射型
这种的攻击方是指恶意脚本作为网络请求的一部分，有时候服务器会将到请求里面的脚本作为响应内容返回给浏览器，恶意脚本因而能够在浏览器上执行。

### 文档型
文档型的XSS攻击不会经过服务端，而是作为中间人的角色，在数据传输过程中劫持数据包，然后修改里面的html文档。

### 防范
1. 前后端对于用户的输入都要进行转码或者过滤
2. 利用浏览器的内容安全策略，核心思想是服务器决定浏览器加载哪些资源
3. 设置Cookie的HttpOnly属性，禁止js读取cookie

## CSRF
跨站请求伪造攻击是指黑客诱导用户点击连接，打开黑客的网站，然后黑客利用用户目前的登录状态发起跨站请求，这个请求会携带用户的cookie信息，让服务器误认为是正常的用户。
具体的攻击方式主要是自动的GET请求（图片的src）、自动POST请求（自动提交表单的脚本）、诱导点击发送GET请求（a标签）

### 防范
1. 设置Cookie的SameSite属性
2. 验证来源站点，原理是通过请求头的Origin和Referer字段，但是这个做法安全性略差，因此这两个头字段可以伪造。
3. Token

SameSite取值
- Strict 完全禁止第三方 Cookie，跨站点时，任何情况下都不会发送 Cookie
- Lax 大多数情况也是不发送第三方 Cookie，但是导航到目标网址的 Get 请求除外
- None 没有限制