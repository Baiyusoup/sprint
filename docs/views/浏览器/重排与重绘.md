---
title: 重排与重绘
date: 2021-07-12
categories: 
 - 浏览器
---

## 重排/回流
当DOM的变化影响到元素的几何信息时，浏览器需要重新计算浏览器的几何信息，将其放在页面上正确的位置，这个过程就叫做重排。简单来说就是重新布局、重新排列元素。

#### 发生的时机
1. 页面初始渲染
2. 添加或删除可见的DOM
3. 改变元素的位置、大小、内容、字体
4. 修改元素style属性的值
5. 激活css伪类，比如`:hover`
6. 改变浏览器窗口的尺寸
7. 查询元素的几何属性，比如`offsetWidth`
8. 调用某些计算方法，比如`getComputedStyle`

## 重绘
元素的外观发生变化，但没有改变元素的布局，这时候浏览器只需要重新渲染的它的外观即可，这个过程就是重绘。

## 区别
重排一定会引起重绘，重绘不一定会引起重排，因此重排的代价比重绘要大。

## 优化
1. 修改样式时使用className、style.cssText修改，不要一条一条的修改
2. 在对DOM进行负责操作的时候，先把它隐藏起来（`display:node`），当操作完了再显示
3. 获取并操作那些会引起浏览器回流的属性时，应该先用变量缓存起来，再操作。
4. 不使用table布局，因此在table布局中，有点变化就可能引起整个table的重新布局。
5. 添加大量dom时，可以先添加到文档片段`DocumentFragment`，完事后才将文档片段添加到DOM树上
